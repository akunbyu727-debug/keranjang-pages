<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin ‚Äì Tambah Produk</title>
<style>
    :root {
        color-scheme: dark;
    }
    body {
        background: #0d1117;
        color: #e6edf3;
        font-family: Arial, sans-serif;
        padding: 20px;
        margin: 0;
        box-sizing: border-box;
    }
    h1 {
        color: #58a6ff;
        margin: 0 0 4px 0;
        font-size: 22px;
    }
    .subtitle {
        font-size: 13px;
        color: #8b949e;
        margin-bottom: 16px;
    }
    .tabs {
        display: inline-flex;
        border-radius: 999px;
        background: #161b22;
        padding: 3px;
        border: 1px solid #30363d;
        margin-bottom: 16px;
    }
    .tab-btn {
        border: none;
        background: transparent;
        color: #8b949e;
        padding: 7px 16px;
        font-size: 13px;
        border-radius: 999px;
        cursor: pointer;
    }
    .tab-btn.active {
        background: #1f6feb;
        color: #ffffff;
    }
    .tab-btn:not(.active):hover {
        background: #21262d;
    }
    .panel {
        border: 1px solid #30363d;
        border-radius: 10px;
        padding: 16px;
        background: #0d1117;
        max-width: 800px;
    }
    .panel h2 {
        margin: 0 0 6px 0;
        font-size: 18px;
        color: #79c0ff;
    }
    .panel p {
        margin: 4px 0 10px 0;
        font-size: 13px;
        color: #8b949e;
    }
    textarea {
        width: 100%;
        height: 180px;
        background: #161b22;
        color: #e6edf3;
        border: 1px solid #30363d;
        border-radius: 6px;
        padding: 10px;
        resize: vertical;
        box-sizing: border-box;
        font-size: 13px;
    }
    button.action {
        background: #238636;
        color: #ffffff;
        border: none;
        padding: 10px 20px;
        font-size: 14px;
        margin-top: 10px;
        border-radius: 6px;
        cursor: pointer;
    }
    button.action:hover {
        opacity: 0.9;
    }
    .hint {
        font-size: 11px;
        color: #8b949e;
        margin-top: 8px;
    }
    .hidden {
        display: none;
    }
    .badge {
        display: inline-block;
        font-size: 11px;
        padding: 2px 8px;
        border-radius: 999px;
        background: #1f6feb33;
        color: #79c0ff;
        margin-left: 4px;
    }
</style>
</head>

<body>
    <h1>Tambah Produk</h1>
    <div class="subtitle">
        Paste banyak link, satu per baris. Idealnya ¬±300 link per kirim biar aman ‚è±Ô∏è
    </div>

    <!-- TAB SWITCHER -->
    <div class="tabs">
        <button id="tab-shopee" class="tab-btn active" onclick="setTab('shopee')">
            Shopee <span class="badge">Shortlink & Product</span>
        </button>
        <button id="tab-tiktok" class="tab-btn" onclick="setTab('tiktok')">
            TikTok <span class="badge">Video & Shop</span>
        </button>
    </div>

    <!-- PANEL SHOPEE -->
    <div id="panel-shopee" class="panel">
        <h2>Shopee</h2>
        <p>Tempel banyak link Shopee (bisa shortlink <code>s.shopee.co.id</code> atau link produk full):</p>
        <textarea id="ta-shopee" placeholder="https://s.shopee.co.id/xxxx
https://shopee.co.id/product/123456/987654
Tas link no 29 https://shopee.co.id/...
Sandal link no 30 https://s.shopee.co.id/..."></textarea>
        <button class="action" onclick="kirimBatch('shopee')">Tambah ke Sheet dari Shopee</button>
        <div class="hint">
            Tips: Kalau link pakai teks depan (misal: &quot;Tas link no 29 https...&quot;), script tetap ambil URL-nya saja.  
            Bagi per ¬±300 link per batch untuk ribuan produk.
        </div>
    </div>

    <!-- PANEL TIKTOK -->
    <div id="panel-tiktok" class="panel hidden">
        <h2>TikTok</h2>
        <p>Tempel banyak link TikTok (video / TikTok Shop):</p>
        <textarea id="ta-tiktok" placeholder="https://www.tiktok.com/@username/video/1234567890
https://vt.tiktok.com/xxxxxx
OOTD hijab https://www.tiktok.com/@.../video/...."></textarea>
        <button class="action" onclick="kirimBatch('tiktok')">Tambah ke Sheet dari TikTok</button>
        <div class="hint">
            Selama Google Apps Script kamu ambil <code>og:title</code> &amp; <code>og:image</code>,  
            TikTok juga akan keisi judul + gambar otomatis sama seperti Shopee.
        </div>
    </div>

<script>
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbx6vDfSmRyOUYylz9BprdAr_1vKJIBliXXOeOENmFMoYGCDKjO93IyDohZTx58Aoqk/exec";

function setTab(name) {
    const tabs = ['shopee', 'tiktok'];

    tabs.forEach(t => {
        const btn = document.getElementById('tab-' + t);
        const panel = document.getElementById('panel-' + t);
        if (t === name) {
            btn.classList.add('active');
            panel.classList.remove('hidden');
        } else {
            btn.classList.remove('active');
            panel.classList.add('hidden');
        }
    });
}

function extractLinks(raw) {
    // Ambil semua URL dari teks (kalau ada teks tambahan di depan)
    const urlRegex = /(https?:\/\/[^\s]+)/g;
    const links = [];
    let match;
    while ((match = urlRegex.exec(raw)) !== null) {
        links.push(match[1].trim());
    }
    return links;
}

function kirimBatch(source) {
    const textareaId = source === 'tiktok' ? 'ta-tiktok' : 'ta-shopee';
    const el = document.getElementById(textareaId);
    const raw = (el.value || "").trim();

    if (!raw) {
        alert("Isi link dulu bro üôè");
        return;
    }

    // Bisa handle format: "Tas link no 29 https://shopee..." ‚Üí tetap ambil URL-nya
    const list = extractLinks(raw).filter(x => x);

    if (list.length === 0) {
        alert("Tidak ada URL valid yang ketemu.");
        return;
    }

    if (list.length > 300) {
        const ok = confirm("Total link: " + list.length + ".\nDisarankan maksimal 300 per batch biar aman timeout.\nTetap kirim semua?");
        if (!ok) return;
    }

    const params = new URLSearchParams();
    params.set("mode", "batch");
    params.set("links", JSON.stringify(list));
    // Opsional kalau nanti mau dipakai di Apps Script:
    // params.set("source", source); // 'shopee' atau 'tiktok'

    window.open(WEBAPP_URL + "?" + params.toString(), "_blank");
}
</script>

</body>
</html>
