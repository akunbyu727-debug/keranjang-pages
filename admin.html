<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin â€“ Koleksiku</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />

  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: "Inter", sans-serif;
      background: #0b1622;
      color: #ffffff;
    }

    .wrap {
      max-width: 650px;
      margin: 0 auto;
    }

    h1 {
      font-size: 24px;
      text-align: center;
      margin-bottom: 4px;
    }

    .sub {
      text-align: center;
      font-size: 13px;
      color: #c3d0df;
      margin-bottom: 18px;
    }

    /* Tabs */
    .tabs {
      display: flex;
      background: #111d2a;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid #1f2937;
      margin-bottom: 16px;
    }
    .tab {
      flex: 1;
      text-align: center;
      padding: 10px 0;
      font-weight: 600;
      color: #9fb0c4;
      cursor: pointer;
      user-select: none;
    }
    .tab.active {
      background: #ff7f00;
      color: #ffffff;
    }

    /* Panel */
    .panel { display: none; }
    .panel.active { display: block; }

    /* Box */
    .box {
      background: #111d2a;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 20px;
      border: 1px solid #1f2937;
      box-shadow: 0px 3px 12px rgba(0,0,0,0.35);
    }
    .box h2 {
      font-size: 17px;
      margin: 0 0 6px;
    }
    .box p {
      font-size: 13px;
      color: #c3d0df;
      margin: 4px 0 10px;
    }

    textarea {
      width: 100%;
      min-height: 110px;
      border-radius: 10px;
      padding: 10px;
      font-size: 13px;
      background: #020617;
      border: 1px solid #1f2937;
      color: #e5e7eb;
      resize: vertical;
    }

    button {
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      background: #ff7f00;
      color: #fff;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      margin-top: 8px;
    }
    button:hover { background: #ff9933; }

    /* Log */
    .log-title {
      margin-top: 10px;
      margin-bottom: 4px;
      font-size: 13px;
      color: #c3d0df;
    }

    .log {
      background: #020617;
      border-radius: 10px;
      padding: 10px;
      font-size: 12px;
      border: 1px solid #1f2937;
      height: 220px;
      overflow-y: auto;
      white-space: pre-line;
      font-family: monospace;
    }
  </style>
</head>

<body>

<div class="wrap">
  <h1>Admin â€“ Koleksiku</h1>
  <div class="sub">Tambah produk Shopee otomatis â€¢ Judul & Gambar langsung ke Sheet</div>

  <!-- TABS -->
  <div class="tabs">
    <div id="tab-shopee" onclick="setTab('shopee')" class="tab active">ðŸ›’ Shopee</div>
    <div id="tab-tiktok" onclick="setTab('tiktok')" class="tab">ðŸŽµ TikTok</div>
  </div>

  <!-- SHOPEE PANEL -->
  <div id="panel-shopee" class="panel active">
    <div class="box">
      <h2>ðŸ›’ Tambah Shopee</h2>
      <p>Tempel link Shopee <b>1 per baris</b>. Sistem otomatis ambil <b>nama produk + gambar</b>.</p>

      <textarea id="shopee-input" placeholder="https://s.shopee.co.id/abc123&#10;https://s.shopee.co.id/xyz456"></textarea>
      <button onclick="sendShopee()">Tambah Produk Shopee</button>
    </div>
  </div>

  <!-- TIKTOK PANEL -->
  <div id="panel-tiktok" class="panel">
    <div class="box">
      <h2>ðŸŽµ TikTok (Coming soon)</h2>
      <textarea placeholder="Belum aktif" disabled></textarea>
      <button disabled>Menunggu endpoint TikTok</button>
    </div>
  </div>

  <!-- LOG -->
  <div class="log-title">ðŸ“œ Log proses</div>
  <div id="log" class="log">Siap menerima perintahâ€¦</div>
</div>

<script>
  // URL WebApp GAS â€” SUDAH DIISI
  const WEBAPP_URL =
    "https://script.google.com/macros/s/AKfycbzRz67r35i87LMaa1LQY8iXEGml1tXifHIPvbE2ui006afojMmGswS3ipzAC27dOB9G/exec";

  function setTab(x) {
    document.getElementById("tab-shopee").classList.toggle("active", x === "shopee");
    document.getElementById("tab-tiktok").classList.toggle("active", x === "tiktok");

    document.getElementById("panel-shopee").classList.toggle("active", x === "shopee");
    document.getElementById("panel-tiktok").classList.toggle("active", x === "tiktok");
  }

  function log(msg) {
    const L = document.getElementById("log");
    L.textContent += "\n" + msg;
    L.scrollTop = L.scrollHeight;
  }

  // ==============================
  // ðŸ”¥ SHOPEE â€” KIRIM VIA GET
  // ==============================
  async function sendShopee() {
    const raw = document.getElementById("shopee-input").value.trim();

    document.getElementById("log").textContent = "â³ Mulai proses Shopee...\n";

    if (!raw) {
      alert("Isi dulu link Shopee-nya bro.");
      return;
    }

    const linksArr = raw
      .split(/\r?\n/)
      .map(s => s.trim())
      .filter(Boolean);

    log("Total link: " + linksArr.length);

    try {
      // Kirim semua link sebagai satu parameter GET
      const qs = new URLSearchParams({ links: raw });
      const url = WEBAPP_URL + "?" + qs.toString();

      const res = await fetch(url);  // SIMPLE GET â†’ 100% anti CORS
      let txt;

      try {
        const data = await res.json();
        txt = JSON.stringify(data);
      } catch (err) {
        txt = await res.text();
      }

      log("âœ” Respon WebApp: " + txt);

    } catch(e) {
      log("âœ– ERROR menghubungi WebApp: " + e);
    }

    log("\nðŸŽ‰ Selesai. Cek sheet 'data' apakah baris baru sudah masuk.");
  }
</script>

</body>
</html>
