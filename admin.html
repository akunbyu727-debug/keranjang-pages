<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin Tambah Produk</title>

  <style>
    body{
      font-family: Arial, sans-serif;
      padding:20px;
      background:#f5f5f5;
    }
    h2{margin-bottom:6px}
    textarea{
      width:100%;
      height:120px;
      padding:10px;
      border-radius:6px;
      border:1px solid #ccc;
      margin-bottom:10px;
      font-size:14px;
      resize: vertical;
    }
    button{
      padding:10px 18px;
      border:none;
      background:#ff6b00;
      color:white;
      border-radius:6px;
      cursor:pointer;
      font-size:14px;
      margin-top:4px;
    }
    button:hover{opacity:0.85}
    .box{background:white;padding:16px;border-radius:10px;margin-bottom:20px;box-shadow:0 3px 10px rgba(0,0,0,0.1)}
    .log{
      white-space:pre-line;
      background:#111;
      color:#0f0;
      padding:12px;
      margin-top:15px;
      border-radius:6px;
      font-size:13px;
      height:180px;
      overflow:auto;
    }
  </style>
</head>

<body>

<h2>üîß Admin Tambah Produk Shopee</h2>
<div class="box">
  <p>Masukkan link Shopee (1 per baris):</p>
  <textarea id="shopee-input" placeholder="https://shopee.co.id/..."></textarea>
  <button onclick="sendShopee()">Tambah Shopee</button>
</div>

<h2>üéµ Admin Tambah Produk TikTok</h2>
<div class="box">
  <p>Link TikTok (1 per baris):</p>
  <textarea id="tiktok-links" placeholder="https://www.tiktok.com/..."></textarea>

  <p>Judul (1 per baris, boleh kosong):</p>
  <textarea id="tiktok-titles" placeholder="Nama produk..."></textarea>

  <p>Gambar (1 per baris, opsional):</p>
  <textarea id="tiktok-images" placeholder="https://...jpg"></textarea>

  <button onclick="sendTikTok()">Tambah TikTok</button>
</div>

<h2>üìú Log</h2>
<div id="log" class="log"></div>

<script>
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbzRz67r35i87LMaa1LQY8iXEGml1tXifHIPvbE2ui006afojMmGswS3ipzAC27dOB9G/exec";

/* ====================================================
      SHOPEE ‚Äî format EXACT seperti bookmark lama
   ==================================================== */
async function sendShopee(){
    const raw = document.getElementById("shopee-input").value.trim();
    const logBox = document.getElementById("log");
    logBox.textContent = "‚è≥ Mulai kirim Shopee...\n";

    if(!raw){
        alert("Isi link Shopee dulu!");
        return;
    }

    const list = raw.split("\n").map(x => x.trim()).filter(x => x);

    for(const link of list){
        const qs = new URLSearchParams({
            link: link,
            title: "Produk",
            image: "",
            no: "",
            source: "shopee"
        });

        const url = WEBAPP_URL + "?" + qs.toString();

        try{
            const res = await fetch(url);
            const txt = await res.text();

            logBox.textContent += "‚úî " + link + " ‚Üí " + txt + "\n";
        }
        catch(err){
            logBox.textContent += "‚úñ " + link + " ‚Üí ERROR: " + err + "\n";
        }

        await new Promise(r => setTimeout(r, 300));
    }

    logBox.textContent += "\nüéâ Selesai Shopee!\n";
}

/* ====================================================
      TIKTOK ‚Äî batch mode (Apps Script sudah mendukung)
   ==================================================== */
async function sendTikTok(){
    const links  = document.getElementById("tiktok-links").value.trim();
    const titles = document.getElementById("tiktok-titles").value.trim();
    const images = document.getElementById("tiktok-images").value.trim();
    const logBox = document.getElementById("log");

    logBox.textContent = "‚è≥ Mulai kirim TikTok...\n";

    if(!links){
        alert("Isi minimal link TikTok");
        return;
    }

    const qs = new URLSearchParams({
        mode: "batch",
        source: "tiktok",
        links,
        titles,
        images
    });

    const url = WEBAPP_URL + "?" + qs.toString();
    try{
        const res = await fetch(url);
        const txt = await res.text();
        logBox.textContent += "‚úî TikTok batch ‚Üí " + txt + "\n";
    }
    catch(err){
        logBox.textContent += "‚úñ ERROR TikTok: " + err + "\n";
    }

    logBox.textContent += "\nüéâ Selesai TikTok!\n";
}
</script>

</body>
</html>
